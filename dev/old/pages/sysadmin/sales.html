<div id="sysadmin_Sales_PageContainer" style="width:100%;height:100%;">
    <div id="sysadmin_Sales_ContentPaneLeft" style="width:255px;height:100%; margin:0;padding:0;">
        <table>
            <tr><th>Кассовые аппараты<br/>(тип ЭККА MINI-T)</th></tr>
            <tr><td id="sysadmin_Sales_CrsButtons"></td></tr>
        </table>
    </div>
    <div id="sysadmin_Sales_ContentPaneDetailContainer" style="width:100%;height:100%; margin:0;padding:0;"></div>
</div>
<script type="text/javascript">
    require(["app", "dojo/dom-style", "dijit/layout/BorderContainer", "dijit/layout/StackContainer", "dijit/layout/ContentPane",
                "dijit/form/Button", "app/templateDocumentSimpleTable","app/request"],
            function (APP, domStyle, BorderContainer, StackContainer, ContentPane, Button, TDocumentSimpleTable, Request) {
                var sysadmin_Sales_PageContainer=
                        APP.instanceForID("sysadmin_Sales_PageContainer", BorderContainer, {});
                APP.instanceForID("sysadmin_Sales_ContentPaneLeft", ContentPane, {region:'left', splitter:true});
                var sysadmin_Sales_ContentPaneDetailContainer=
                        APP.instanceForID("sysadmin_Sales_ContentPaneDetailContainer", StackContainer, {region:'center'});
                var sysadmin_Sales_CrsButtons=document.getElementById("sysadmin_Sales_CrsButtons");
                var btnAllCRs;

                sysadmin_Sales_PageContainer.addButtonTo = function (parent, id, name) {
                    var button = new Button({id:id, label:name, style:"margin-left:2px;;margin-right:1px;"});
                    button.onClick= function(){
                        var instance=this;
                        if (!button.document){
                            button.document =
                                    APP.childFor(sysadmin_Sales_ContentPaneDetailContainer, "sysadmin_Sales_TableSales"+instance.id,
                                            TDocumentSimpleTable, {titleText:instance.label, dataURL:'/sysadmin/Sales/get_sales_for_crid/'+instance.id, buttonPrint:false})
                                            .addBeginDateBox("с","BDATE",APP.yesterday()).addEndDateBox("по","EDATE",APP.yesterday())
                                            .addTotalCountNumberBox("ИТОГО строк:", 140, {style:"font-weight:bold;",inputStyle:"width:50px;"})
                                            .addTotalSumNumberTextBox("ИТОГО кол-во:",810, "Qty", {style:"font-weight:bold;",inputStyle:"width:55px;"})
                                            .addTotalSumNumberTextBox("ИТОГО сумма:",190, "Sum_wt", {style:"font-weight:bold;",inputStyle:"width:85px;",pattern:"###,###,##0.00##"})
                                    .startUp();
                        }
                        sysadmin_Sales_ContentPaneDetailContainer.selectChild(button.document);
                    };
                    button.domNode.firstChild.setAttribute("style", "width:239px;");
                    button.startup();
                    sysadmin_Sales_CrsButtons.appendChild(button.domNode);
                    return button;
                };
                sysadmin_Sales_PageContainer.createReportButtons=function(){
                    Request.getJSONData({url: "/sysadmin/get_all_cashboxes",consoleLog: true},
                            function(result,error){                                                         console.log("createReportButtons result=",result);
                                if(error||!result){
                                    sysadmin_Sales_PageContainer.innerHTML = "<div><b style='color:red'>No connection!</b></div>";
                                    return;
                                }
                                for(var i in result.items) {
                                    var item=result.items[i];
                                    sysadmin_Sales_PageContainer.addButtonTo(sysadmin_Sales_CrsButtons, "Sales"+item.CRID,item.CRName+" "+item.FacID);
                                }
                                btnAllCRs= sysadmin_Sales_PageContainer.addButtonTo(sysadmin_Sales_CrsButtons, "Sales-1", "Все кассы");
                                btnAllCRs.onClick();
                            });

                };
                sysadmin_Sales_PageContainer.createReportButtons();
                sysadmin_Sales_PageContainer.layout();
            });
</script>